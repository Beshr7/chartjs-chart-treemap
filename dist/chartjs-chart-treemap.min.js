/*!
 * chartjs-chart-treemap v0.1.1
 * https://github.com/kurkle/chartjs-chart-treemap#readme
 * (c) 2019 Jukka Kurkela
 * Released under the MIT license
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):e((t=t||self).Chart)}(this,function(t){"use strict";function e(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}t=t&&t.hasOwnProperty("default")?t.default:t;var r={qsort:function t(r,i,n){var o;(i=void 0===i?0:i)<(n=void 0===n?r.length-1:n)&&(o=function(t,r,i,n){for(var o=t[r],s=i;i<n;i++)t[i]<o&&(e(t,i,s),s++);return e(t,n,s),s}(r,n,i,n),t(r,i,o-1),t(r,o+1,n))},qrsort:function t(r,i,n){var o;(i=void 0===i?0:i)<(n=void 0===n?r.length-1:n)&&(o=function(t,r,i,n){for(var o=t[r],s=i;i<n;i++)t[i]>o&&(e(t,i,s),s++);return e(t,s,n),s}(r,n,i,n),t(r,i,o-1),t(r,o+1,n))},sum:function(t){var e,r,i=0;for(e=0,r=t.length;e<r;++e)i+=t[e];return i}},i=function(t){var e=this;e.x=e._ix=t.x||0,e.y=e._iy=t.y||0,e.w=t.w||t.width||t.right-t.left||400,e.h=t.h||t.height||t.bottom-t.top||300};function n(t,e){return+(Math.round(t+"e+"+e)+"e-"+e)}Object.defineProperties(i.prototype,{iw:{get(){return this.w-this._ix}},ih:{get(){return this.h-this._iy}},dir:{get(){var t=this.iw,e=this.ih;return e<=t&&e>0?"y":"x"}},side:{get(){return"x"===this.dir?this.iw:this.ih}}}),i.prototype.map=function(t,e){var r,i,o,s,a,h,u,_,d=this,p=[],l=t.length,m=d.dir,c=d.side,f=c*c,x="x"===m?"_ix":"_iy",g="y"===m?"_ix":"_iy",v=e*e,y=0,w=0;for(r=0;r<l;++r)[i,o]=t[r],s=f*o/v,w+=u=Math.sqrt(o*s),(_=o/u)>y&&(y=_),a="_ix"===x?u:_,h="_ix"===x?_:u,p.push({x:n(d._ix,4),y:n(d._iy,4),w:n(a,4),h:n(h,4),a:o,v:i}),d[x]+=u;return d[g]+=y,d[x]-=w,p};class o{constructor(t){this._ratio=t,this.reset()}push(t){var e=this,r=t*e._ratio;e._row.push([t,r]),e.__sum=e._sum,e._sum+=r,null===e._min||e._min>r?(e.__min=e._min,e._min=r):e.__min=e._min,null===e._max||e._max<r?(e.__max=e._max,e._max=r):e.__max=e._max}pop(){var t=this,[e,r]=t._row.pop();return t._sum-=r,t._min=t.__min,t._max=t.__max,e}reset(t){var e=this;e._row=[],e._sum=0,e._min=e.__min=null,e._max=e.__max=null,e._w=t}ok(){var t=this,e=t._sum*t._sum,r=t.__sum*t.__sum,i=t._w*t._w;return Math.max(i*t._max/e,e/(i*t._min))<=Math.max(i*t.__max/r,r/(i*t.__min))}get(){return this._row}}function s(t,e){var n,s,a=new i(e),h=a.h*a.w/r.sum(t),u=t.length,_=new o(h),d=[];for(t=t.slice(),r.qrsort(t),_.reset(a.side),n=0;n<u;++n)_.push(t[n]),_.length>1&&!_.ok()&&(s=_.pop(),d.push(a.map(_.get(),_.sum)),_.reset(a.side),_.push(s));return _.length&&d.push(a.map(_.get(),_.sum)),function(t){const e=[...t],r=[];for(;e.length;){const t=e.pop();Array.isArray(t)?e.push(...t):r.push(t)}return r.reverse()}(d)}Object.defineProperties(o.prototype,{length:{get(){return this._row.length}},sum:{get(){return this._sum}}});var a=t.helpers.options.resolve,h=t.DatasetController.extend({dataElementType:t.elements.Rectangle,update:function(t){var e,r,i=this,n=i.getMeta(),o=i.getDataset(),a=n.data||[];for(i._sqdata=s(o.data,i.chart.chartArea),e=0,r=a.length;e<r;++e)i.updateElement(a[e],e,t)},updateElement:function(t,e,r){var i=this.index,n=this._sqdata[e],o=this._resolveElementOptions(t,e),s=this.chart.chartArea,a=n.x+s.left+n.w/2,h=s.top+n.y+n.h/2,u=r?0:n.h-2*o.spacing,_=r?0:n.w-2*o.spacing,d=u/2;t._options=o,t._datasetIndex=i,t._index=e,t._model={x:a,base:h-d,y:h+d,width:_,height:u,backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderSkipped:o.borderSkipped,borderWidth:o.borderWidth},t.pivot()},draw:function(){var t,e,r=this.getMeta().data||[];for(t=0,e=r.length;t<e;++t)r[t].draw()},_resolveElementOptions:function(t,e){var r,i,n,o=this.chart,s=o.data.datasets[this.index],h=o.options.elements.rectangle,u={},_={chart:o,dataIndex:e,dataset:s,datasetIndex:this.index},d=["backgroundColor","borderColor","borderSkipped","borderWidth","spacing"];for(r=0,i=d.length;r<i;++r)u[n=d[r]]=a([s[n],h[n]],_,e);return u}});t.controllers.treemap=h,t.defaults.treemap={hover:{mode:"nearest",intersect:!0},tooltips:{mode:"nearest",position:"treemap",intersect:!0},scales:{xAxes:[{type:"linear",display:!1}],yAxes:[{type:"linear",display:!1}]},elements:{rectangle:{borderSkipped:!1,borderWidth:0,spacing:.5}}},t.Tooltip.positioners.treemap=function(t){if(!t.length)return!1;var e=t[0]._view;return{x:e.x,y:e.y-e.height/2}}});
